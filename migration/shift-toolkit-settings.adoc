---
sidebar: sidebar
permalink: migration/shift-toolkit-settings.html
keywords: netapp, vmware, esxi, vm, migration, openshift, virtualization, hyper-v, proxmox
summary: 
---

= Advanced settings for the Shift Toolkit
:hardbreaks:
:nofooter:
:icons: font
:linkattrs:
:imagesdir: ../media/

[.lead]
Shift toolkit provides advanced settings that provides which can be accessed by clicking the Settings icon in the top toolbar.

image::shift-toolkit-250.png["Dialog showing how to access the advanced settings"]

== CredSSP

Shift leverages Credential Security Service Provider (CredSSP) to manage the credentials transfer. During the conversion process, the Shift server runs a number of scripts on the guest OS of the VM being converted. The credentials to run these scripts are passed via a "double-hop" from the Shift server to the guest OS through the Hyper-V server.

image::shift-toolkit-251.png["Dialog showing how to access the specified settings"]

=== Configuring the Shift server as a CredSSP client

The "Advanced Settings" wizard automatically configures the Shift server as a CredSSP client. Doing so enables the Shift server to delegate credentials to the Hyper-V servers. 

==== What happens behind the scenes

The Shift toolkit executes a series of commands to configure itself as a client, enabling it to manage Hyper-V hosts. This process involves setting up necessary configurations.

* Runs these commands:
** Set-Item WSMan:\localhost\Client\TrustedHosts -Value "fqdn-of-hyper-v-host"
** Enable-WSManCredSSP -Role client -DelegateComputer "fqdn-of-hyper-v-host"
* Configures the following group policy:
** Computer Configuration > Administrative Templates > System > Credentials Delegation > Allow delegating fresh credentials with NTLM-only server authentication 
Select Enable and add wsman/fqdn-of-hyper-v-host.

=== Configuring the Hyper-V server as a CredSSP server

Use the Enable-WSManCredSSP cmdlet on Hyper-V server to configure the Hyper-V server as a CredSSP server, which enables the Hyper-V server to receive credentials from the Shift server.

On the Hyper-V host where the virtual machines will be provisioned by Shift toolkit server, open a Windows PowerShell session as Administrator and run the following commands:

. Enable-PSRemoting
. Enable-WSManCredSSP -Role server

== Logging

The Shift toolkit includes default logging, with logs retained for 30 days. Logging can be switched to debug mode upon request from support for troubleshooting purposes.

image::shift-toolkit-252.png["Dialog showing how to access the specified settings"]

== Swagger

The swagger page in the Advanced setting allows interaction with available APIs. 

image::shift-toolkit-253.png["Dialog showing how to access the specified settings"]

The resources available through the Shift toolkit REST API are organized in categories, as displayed on the swagger API documentation page. A brief description of each of the resources with the base resource paths is presented below, along with additional usage considerations where appropriate.

image::shift-toolkit-254.png["Dialog showing how to access the specified settings"]

*Session*

You can use this API to log into the Shift toolkit Server. This API returns a user authorization token that is used to authenticate subsequent requests.

* Start a session
* Validate a session
* Get all session ID
* End a session

*Connector*

* Add a connector
* Get details of all connectors
* Update the connector details by ID
* Get connector details by ID

*Tenant*

Use APIs to perform Add and Get operations

* Add tenant
* Get all tenant

*User*

Use APIs to perform Add, get, change and accept operations

* Add User
* Get all user
* Change password of the user
* Accept EULA

*CredSSP*

Use APIs to perform enable and get operations

* Enable credssp
* Get status of credssp

*Site*

Use APIs to perform get, add, delete and update operations

* Get count of sites
* Get all site details
* Add a site
* Get site detail by ID
* Delete a site by ID
* Add virtual environment to a site
* Add storage environment to a site
* Get virtual environment detail for a site
* Update virtual environment detail for a site
* Delete virtual environment detail for a site
* Get storage environment detail for a site
* Update storage environment detail for a site
* Delete storage environment detail for a site

*Discovery*

Use APIs to perform discover and get operations

* Discover source site
* Get all discovery requests for source site
* Discover target site
* Get all discovery requests for target site
* Get discovery steps for source site by Id
* Get discovery steps for target site by Id

*VM*

Use APIs to perform get operations

* Get VMs for a site and virtual environment in source
* Get unprotected VMs for a site and virtual environment
* Get VM count
* Get protected VM count

*Resource*

Use APIs to perform get operations

* Get resource details for a site and virtual environment
* Get source site resources count 
  
*Resource Group*

Use APIs to perform add, update and get operations

* Get protection group count
* Get all protection group details
* Add a protection group
* Get a protection group details by Id
* Delete a protection group by Id
* Update protection group details by Id
* Get VMs of a protection group by Id
* Get Blueprints containing the protection group

*Blueprint*

Use APIs to perform add, update and get operations

* Get Blueprint Count
* Get all Blueprint details
* Add a Blueprint
* Get blueprint details by Id
* Delete blueprint by Id
* Update blueprint details for Id
* Get VMs of a blueprint
* Get power status of VMs present in the blueprint
* Get blueprint Count
* Get all blueprint details

*Compliance*

Use APIs to perform add and get operations

* Get compliance check result for a blueprint
* Get compliance check final status for a blueprint
* Add on demand new compliance check for a blueprint

*Execution*

Use APIs to perform get operations

* Get all execution details
* Get details of execution in progress
* Get execution count
* Get count of executions in progress
* Get steps for execution Id

*Recovery*

Use APIs to perform add and get operations

* Add new execution request for a Blueprint
* Add retry request of execution for a Blueprint
* Get execution statuses of all Blueprints
* Get execution status for Blueprint ID

*Script Block*

Use APIs to perform get and update operations

* Get all scripts metadata
* Get script metadata by Id
* Get all refresh metadata
* Execute script

== Script block

The script block within in Shift toolkit provides sample code that help automate, integrate and develop features via internal and external APIs available. On the Code Samples section in the script block, browse and download samples written by Shift toolkit Automation team and by the community members. Use the samples to get started with automation, management or integration tasks.

image::shift-toolkit-255.png["Dialog showing how to access the specified settings"]

image::shift-toolkit-256.png["Dialog showing how to access the specified settings"]

Here is an example of a sample powershell script which can be used to delete a specific job within Shift UI. The capability is not exposed via workflow, however the same can accomplished via the script block. The same script is also available as a bat script that can executed easily by downloading and calling the same.

image::shift-toolkit-257.png["Dialog showing how to access the specified settings"]

The objective here is to provide sample scripts to perform day 0 and day N operations for specific hypervisors using the Shift toolkit APIs and the respective hypervisor published APIs. 

== Email Notification & alerts

Email notification can be configured to send alerts about discovery, conversion or migration jobs to specified recipients. UI notification (aka alerts within the UI) are also available which is stored for 7 days.

The email Notification settings are under the Settings pane (Settings > Platform Settings > Email configuration). 

Procedure to enable notifications:

. Login to Shift toolkit UI 
. Browse to Settings > Platform settings 
. Select Email notifications and update SMTP details including SMTP server address, port, username and password
. Update the "recipient" field and select the events from the available category.
. Once done, click Apply.

image::shift-toolkit-258.png["Dialog showing how to access the specified settings"]

The screenshot above covers the breakdown for each notification category events.

Note: The email notification uses basic SMTP auth and Sendgrid in this release. In a future release, it will support modern authentication. 

== Abort & revert capabilities

Shift toolkit now provides an option to cancel a running job (irrespective of the step within the workflow). Once the job is cancelled, the orphaned components are cleaned up. For instance, this includes cleaning up the VM on hypervisor side including power OFF if the VMs were powered ON, removing the disk entries from the appropriate qtree or deleting the PVCs. Since Shift toolkit do not modify the source VM in any way, it is very easy to turn on the VM. There are no other rollback actions apart from simply powering the VM ON.
